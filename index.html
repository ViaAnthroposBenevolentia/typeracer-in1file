<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Majestic Typing Race</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel&family=Playfair+Display&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A148C;
            --secondary-color: #D1C4E9;
            --accent-color: #FFC107;
            --background-gradient: linear-gradient(to bottom, #0D47A1, #311B92);
            --text-color: #FFFFFF;
            --error-color: #E53935;
            --success-color: #43A047;
            --font-primary: 'Cinzel', serif;
            --font-secondary: 'Playfair Display', serif;
        }
        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-secondary);
            color: var(--text-color);
            background: var(--background-gradient);
            background-attachment: fixed;
            background-size: cover;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header, footer {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
        }
        header h1 {
            margin: 0;
            font-family: var(--font-primary);
            font-size: 3em;
            letter-spacing: 2px;
        }
        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        #quote-display {
            font-size: 1.5em;
            max-width: 800px;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        #quote-input {
            width: 80%;
            max-width: 800px;
            padding: 10px;
            font-size: 1.2em;
            border: none;
            border-bottom: 2px solid var(--accent-color);
            background: transparent;
            color: var(--text-color);
            outline: none;
        }
        #quote-input::placeholder {
            color: var(--secondary-color);
        }
        .hidden {
            display: none;
        }
        .stats {
            margin-top: 20px;
            font-size: 1.2em;
        }
        .button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 1em;
            font-family: var(--font-primary);
            background: var(--accent-color);
            color: #000;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        .button:hover {
            background: var(--secondary-color);
        }
        .correct {
            color: var(--success-color);
        }
        .incorrect {
            color: var(--error-color);
        }
        #progress-bar {
            width: 80%;
            max-width: 800px;
            height: 10px;
            background: var(--secondary-color);
            margin-top: 20px;
            overflow: hidden;
        }
        #progress {
            width: 0%;
            height: 100%;
            background: var(--accent-color);
            transition: width 0.1s;
        }
        @media (max-width: 600px) {
            header h1 {
                font-size: 2em;
            }
            #quote-display {
                font-size: 1.2em;
            }
            #quote-input {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Majestic Typing Race</h1>
    </header>
    <main>
        <div id="quote-display"></div>
        <input type="text" id="quote-input" placeholder="Start typing..." disabled>
        <div id="progress-bar">
            <div id="progress"></div>
        </div>
        <div class="stats hidden" id="stats">
            <p>Time: <span id="time"></span> seconds</p>
            <p>WPM: <span id="wpm"></span></p>
            <p>Accuracy: <span id="accuracy"></span>%</p>
        </div>
        <button class="button" id="start-button">Start Race</button>
    </main>
    <footer>
        <p>Created with ❤️ for typing enthusiasts.</p>
    </footer>
    <script>
        // Passages array (avoid copyrighted material)
        const passages = [
            "The quick brown fox jumps over the lazy dog.",
            "To be or not to be, that is the question.",
            "All that glitters is not gold.",
            "The only thing we have to fear is fear itself.",
            "In the middle of difficulty lies opportunity.",
            "Life is a journey, not a destination.",
            "The early bird catches the worm.",
            "Actions speak louder than words.",
            "Knowledge is power.",
            "Beauty is in the eye of the beholder."
        ];

        const quoteDisplayElement = document.getElementById('quote-display');
        const quoteInputElement = document.getElementById('quote-input');
        const startButton = document.getElementById('start-button');
        const progressBar = document.getElementById('progress');
        const statsElement = document.getElementById('stats');
        const timeElement = document.getElementById('time');
        const wpmElement = document.getElementById('wpm');
        const accuracyElement = document.getElementById('accuracy');

        let startTime;
        let timerInterval;
        let totalTyped = 0;
        let totalErrors = 0;

        function getRandomPassage() {
            const randomIndex = Math.floor(Math.random() * passages.length);
            return passages[randomIndex];
        }

        function startGame() {
            startButton.classList.add('hidden');
            quoteInputElement.disabled = false;
            quoteInputElement.value = '';
            quoteInputElement.focus();
            statsElement.classList.add('hidden');
            progressBar.style.width = '0%';
            totalTyped = 0;
            totalErrors = 0;

            const passage = getRandomPassage();
            quoteDisplayElement.innerHTML = '';
            passage.split('').forEach(char => {
                const charSpan = document.createElement('span');
                charSpan.innerText = char;
                quoteDisplayElement.appendChild(charSpan);
            });

            startTime = new Date();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            const elapsedTime = Math.floor((new Date() - startTime) / 1000);
            timeElement.innerText = elapsedTime;
        }

        quoteInputElement.addEventListener('input', () => {
            const arrayQuote = quoteDisplayElement.querySelectorAll('span');
            const arrayValue = quoteInputElement.value.split('');

            let correct = true;
            totalTyped++;

            arrayQuote.forEach((charSpan, index) => {
                const char = arrayValue[index];
                if (char == null) {
                    charSpan.classList.remove('correct');
                    charSpan.classList.remove('incorrect');
                    correct = false;
                } else if (char === charSpan.innerText) {
                    charSpan.classList.add('correct');
                    charSpan.classList.remove('incorrect');
                } else {
                    charSpan.classList.add('incorrect');
                    charSpan.classList.remove('correct');
                    correct = false;
                    totalErrors++;
                }
            });

            const progress = (arrayValue.length / arrayQuote.length) * 100;
            progressBar.style.width = progress + '%';

            if (correct && arrayValue.length === arrayQuote.length) {
                endGame();
            }
        });

        function endGame() {
            clearInterval(timerInterval);
            quoteInputElement.disabled = true;
            const elapsedTime = (new Date() - startTime) / 1000;
            const wpm = Math.round((quoteInputElement.value.length / 5) / (elapsedTime / 60));
            const accuracy = Math.round(((totalTyped - totalErrors) / totalTyped) * 100);

            timeElement.innerText = Math.floor(elapsedTime);
            wpmElement.innerText = wpm;
            accuracyElement.innerText = accuracy;

            statsElement.classList.remove('hidden');
            startButton.innerText = 'Play Again';
            startButton.classList.remove('hidden');
        }

        startButton.addEventListener('click', startGame);

        // Accessibility: Start game with Enter key when focus is on the button
        startButton.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') {
                startGame();
            }
        });
    </script>
</body>
</html>
